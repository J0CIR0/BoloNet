RewriteEngine On

# Redirigir todas las solicitudes a HTTPS si es necesario
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]

# Prevenir acceso directo a archivos sensibles
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|inc|bak|sql)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Permitir acceso a archivos necesarios
<Files "^(index\.php|verify\.php|public_cursos\.php|register\.php|forgot_password\.php|reset_password\.php)$">
    Order Allow,Deny
    Allow from all
</Files>

# Reglas de reescritura
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]